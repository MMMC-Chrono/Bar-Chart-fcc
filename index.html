<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Bar Chart</title>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.6.1/d3.min.js" integrity="sha512-MefNfAGJ/pEy89xLOFs3V6pYPs6AmUhXJrRlydI/9wZuGrqxmrdQ80zKHUcyadAcpH67teDZcBeS6oMJLPtTqw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        
    </head>
    <body>
        <script src='https://cdn.freecodecamp.org/testable-projects-fcc/v1/bundle.js'></script>
        <script>

        d3.select('body')
          .append('h1')
          .text('title')
          .attr('id', 'title')
          
        fetch('https://raw.githubusercontent.com/freeCodeCamp/ProjectReferenceData/master/GDP-data.json') 
            .then(response => response.json())
            .then(response => {
                const { data } = response;
                collectedData(data)
                console.log({ data })
            })
    
        function collectedData(data) {
            const w = 500;
            const h = 500;
            const padding = 50;

            const xScale = d3.scaleLinear()
                             .domain([d3.min(data, (d) => d[0][0]+d[0][1]+d[0][2]+d[0][3]), d3.max(data, (d) => d[0][0]+d[0][1]+d[0][2]+d[0][3])])
                             .range([padding, w - padding])
            const yScale = d3.scaleLinear()
                            .domain([0, d3.max(data, (d) => d[1])])
                            .range([h - padding, padding])

            const svg = d3.select("body")
                          .append("svg")
                          .attr("width", w)
                          .attr("height", h);

            svg.selectAll("rect")
               .data(data)
               .enter()
               .append("rect")
               .attr('class', 'bar')
               .attr("x", (d, i) => w - yScale(i*66))
               .attr("y", (d) => yScale(d[1]))
               .attr('width', '1')
               .attr('height', (d) => h - yScale(d[1]) - padding)
               .append('title')
               .text((d) => `${d[0]}
            ${d[1]}`)

            const xAxis = d3.axisBottom(xScale);
            const yAxis = d3.axisLeft(yScale)


            svg.append('g')
               .attr('transform', 'translate(0,' + (w - padding) + ')')
               .attr('id', 'x-axis')
               .call(xAxis)
            svg.append('g')
               .attr('transform', 'translate(' + (padding) + ',0)')
               .attr('id', 'y-axis')
               .call(yAxis)
        } 
    
   

        
    
        </script>
    </body>
</html>